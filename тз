Пусть координаты рассчитываются по формулам:
x=x0+Vx*dt+Стох.откл
y=y0+Vy*dt+Стох.откл
z=z0+Vz*dt+Стох.откл
начальные координаты частиц задаются произвольно в рамках куба.

Cтохастические отклонения пусть будут сгенерированы как случайные числа, распределенные по нормальному закону N(0, Dt), где D коэффициент диффузии, который зависит от температуры и вязкости:
D=kT/6*pi*ню*r
k - постоянная больцмана
pi - число пи
ню - вязкость среды
r - радиус частицы
т.е. на отклонение должна влиять среда и радиус частицы (чем среда вязче, тем медленне движется частица)

скорости рассчитываются по следующим формулам:
Vx=Vrms*sin(тета)*cos(фи)
Vy=Vrms*sin(тета)*sin(фи)
Vz=Vrms*cos(тета)
Vrms - среднеквадратическая скорость, зависит от температуры окр среды и массы частицы
